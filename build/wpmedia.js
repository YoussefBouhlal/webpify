(()=>{"use strict";document.addEventListener("DOMContentLoaded",()=>{const{ajaxUrl:t,nonce:e}=WEBPIFY_WPMEDIA,n=t=>{t.classList.add("show-spinner")},a=t=>{t.classList.remove("show-spinner")};document.addEventListener("click",s=>{(s=>{const i=s.target.closest("button.webpify-single-optimization-btn"),o=s.target.closest("button.webpify-undo-single-optimization-btn");i?((s,i)=>{s.preventDefault(),n(i);const o=new FormData;o.append("action","webpify_single_optimization_start"),o.append("_wpnonce",e),o.append("attachment_id",s.target.dataset.attachmentId),fetch(t,{method:"POST",body:o}).then(t=>t.json()).then(t=>{if(a(i),t.success){const e=i.closest("td");e.innerHTML="",e.innerHTML=t.data}else{const e=i.nextElementSibling;e.innerHTML=t.data,e.classList.add("show")}}).catch(()=>{a(i)})})(s,i):o&&((s,i)=>{s.preventDefault(),n(i);const o=new FormData;o.append("action","webpify_single_optimization_undo"),o.append("_wpnonce",e),o.append("attachment_id",s.target.dataset.attachmentId),fetch(t,{method:"POST",body:o}).then(t=>t.json()).then(t=>{if(a(i),t.success){const e=i.closest("td");e.innerHTML="",e.innerHTML=t.data}else{const e=i.nextElementSibling;e.innerHTML=t.data,e.classList.add("show")}}).catch(()=>{a(i)})})(s,o)})(s)})})})();