(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var i=e.n(t);const s=window.wp.element,n=window.wp.apiFetch;var a=e.n(n);const o=window.wp.data,l=window.wp.notices,r=window.wp.i18n,c=window.wp.components,p=window.ReactJSXRuntime,d=()=>{const{removeNotice:e}=(0,o.useDispatch)(l.store),t=(0,o.useSelect)(e=>e(l.store).getNotices());return 0===t.length?null:(0,p.jsx)(c.NoticeList,{notices:t,onRemove:e})},w=({format:e,setFormat:t})=>(0,p.jsx)(c.PanelBody,{title:(0,r.__)("General settings","webpify"),children:(0,p.jsx)("div",{className:"webpify-settings__field-container",children:(0,p.jsx)(c.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,r.__)("Format","webpify"),value:e,options:[{label:(0,r.__)("WebP","webpify"),value:"1"},{label:(0,r.__)("AVIF","webpify"),value:"2"}],onChange:t})})}),_=({display:e,setDisplay:t,doBulkOptimization:i})=>(0,p.jsxs)(c.PanelBody,{title:(0,r.__)("Bulk settings","webpify"),children:[(0,p.jsx)("div",{className:"webpify-settings__field-container",children:(0,p.jsx)(c.RadioControl,{label:(0,r.__)("Display images with new format on the site","webpify"),selected:e,options:[{label:(0,r.__)("Deactivate","webpify"),value:"1"},{label:(0,r.__)("Use <picture> tags","webpify"),value:"2"},{label:(0,r.__)("Use rewrite rules","webpify"),value:"3"}],onChange:t})}),(0,p.jsx)(c.PanelRow,{children:(0,p.jsxs)("div",{className:"webpify-settings__field-container",children:[(0,p.jsx)("div",{className:"webpify-settings__button__label",children:(0,r.__)("Bulk optimization","webpify")}),(0,p.jsx)(c.Button,{variant:"secondary",onClick:i,__next40pxDefaultSize:!0,children:(0,r.__)("Start","webpify")})]})})]}),f=({saveSettings:e})=>(0,p.jsx)(c.PanelBody,{children:(0,p.jsx)(c.Button,{variant:"primary",onClick:e,__next40pxDefaultSize:!0,children:(0,r.__)("Save","webpify")})}),u=()=>{const[e,t]=(0,s.useState)(),[i,n]=(0,s.useState)(),{createSuccessNotice:u,createErrorNotice:y,removeNotice:m}=(0,o.useDispatch)(l.store);return(0,s.useEffect)(()=>{a()({path:"/wp/v2/settings"}).then(e=>{const i=e.webpify_settings;t(i.format),n(i.display)})},[]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d,{}),(0,p.jsxs)(c.Panel,{children:[(0,p.jsx)(w,{format:e,setFormat:t}),(0,p.jsx)(_,{display:i,setDisplay:n,doBulkOptimization:()=>{console.log("doBulkOptimization")}}),(0,p.jsx)(f,{saveSettings:()=>{wp.data.select(l.store).getNotices().forEach(e=>m(e.id)),a()({path:"/wp/v2/settings",method:"POST",data:{[WEBPIFY_SETTINGS.option_name]:{format:e,display:i}}}).then(()=>{u((0,r.__)("Settings saved","webpify"))}).catch(e=>{y(e.message)})}})]})]})};i()(()=>{(0,s.createRoot)(document.getElementById("JS-webpify-settings")).render((0,p.jsx)(u,{}))})})();